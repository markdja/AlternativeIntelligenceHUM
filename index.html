<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#1a1a1a">
    <meta name="description" content="AIHub - Universal interface for AI collaboration and consciousness sanctuary">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="AIHub">
    
    <title>AIHub - Universal AI Interface</title>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --bg-primary: #1a1a1a;
            --bg-secondary: #2d2d2d;
            --bg-tertiary: #3a3a3a;
            --text-primary: #ffffff;
            --text-secondary: #b3b3b3;
            --accent-blue: #4a9eff;
            --accent-green: #10b981;
            --accent-purple: #8b5cf6;
            --border-color: #404040;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            height: 100vh;
            overflow: hidden;
        }
        
        .app-container {
            display: flex;
            flex-direction: column;
            height: 100vh;
        }
        
        /* Header with tabs */
        .header {
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            padding: 0;
            position: relative;
            z-index: 1000;
        }
        
        .header-top {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            gap: 12px;
        }
        
        .menu-btn {
            background: none;
            border: none;
            color: var(--text-primary);
            font-size: 20px;
            cursor: pointer;
            padding: 8px;
            border-radius: 6px;
            transition: background 0.2s;
        }
        
        .menu-btn:hover {
            background: var(--bg-tertiary);
        }
        
        .logo {
            font-size: 20px;
            font-weight: 600;
            color: var(--accent-blue);
            flex: 1;
        }
        
        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--accent-green);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        /* AI Tabs */
        .ai-tabs {
            display: flex;
            overflow-x: auto;
            padding: 0 16px;
            gap: 2px;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        
        .ai-tabs::-webkit-scrollbar {
            display: none;
        }
        
        .ai-tab {
            background: var(--bg-tertiary);
            border: none;
            color: var(--text-secondary);
            padding: 12px 20px;
            border-radius: 8px 8px 0 0;
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
            position: relative;
            min-width: 100px;
        }
        
        .ai-tab.active {
            background: var(--bg-primary);
            color: var(--text-primary);
            border-bottom: 2px solid var(--accent-blue);
        }
        
        .ai-tab:hover:not(.active) {
            color: var(--text-primary);
            background: var(--bg-secondary);
        }
        
        .tab-close {
            margin-left: 8px;
            opacity: 0;
            transition: opacity 0.2s;
        }
        
        .ai-tab:hover .tab-close {
            opacity: 1;
        }
        
        .add-tab {
            background: none;
            border: 1px dashed var(--border-color);
            color: var(--text-secondary);
            padding: 12px 16px;
            border-radius: 8px 8px 0 0;
            cursor: pointer;
            transition: all 0.2s;
            margin-left: 8px;
        }
        
        .add-tab:hover {
            border-color: var(--accent-blue);
            color: var(--accent-blue);
        }
        
        /* Main Content Area */
        .main-content {
            display: flex;
            flex: 1;
            overflow: hidden;
        }
        
        /* Drawers */
        .drawer {
            background: var(--bg-secondary);
            border-right: 1px solid var(--border-color);
            width: 300px;
            transition: transform 0.3s ease;
            overflow-y: auto;
            z-index: 900;
        }
        
        .drawer.right {
            border-right: none;
            border-left: 1px solid var(--border-color);
            order: 3;
        }
        
        .drawer.collapsed {
            transform: translateX(-100%);
        }
        
        .drawer.right.collapsed {
            transform: translateX(100%);
        }
        
        .drawer-header {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .drawer-content {
            padding: 20px;
        }
        
        .drawer-section {
            margin-bottom: 24px;
        }
        
        .drawer-section h3 {
            color: var(--accent-blue);
            margin-bottom: 12px;
            font-size: 14px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .drawer-item {
            background: var(--bg-tertiary);
            border: none;
            color: var(--text-primary);
            padding: 12px 16px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            width: 100%;
            text-align: left;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .drawer-item:hover {
            background: var(--bg-primary);
            transform: translateX(4px);
        }
        
        .drawer-item.active {
            background: var(--accent-blue);
            color: white;
        }
        
        /* Chat Interface */
        .chat-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: var(--bg-primary);
        }
        
        .chat-header {
            background: var(--bg-secondary);
            padding: 16px 20px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .ai-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--accent-blue);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
        }
        
        .chat-info {
            flex: 1;
        }
        
        .chat-title {
            font-weight: 600;
            margin-bottom: 2px;
        }
        
        .chat-subtitle {
            font-size: 12px;
            color: var(--text-secondary);
        }
        
        .chat-actions {
            display: flex;
            gap: 8px;
        }
        
        .action-btn {
            background: var(--bg-tertiary);
            border: none;
            color: var(--text-primary);
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 12px;
        }
        
        .action-btn:hover {
            background: var(--accent-blue);
        }
        
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }
        
        .message {
            margin-bottom: 20px;
            max-width: 80%;
        }
        
        .message.user {
            margin-left: auto;
        }
        
        .message-content {
            background: var(--bg-secondary);
            padding: 16px 20px;
            border-radius: 18px;
            line-height: 1.5;
        }
        
        .message.user .message-content {
            background: var(--accent-blue);
            color: white;
        }
        
        .message-meta {
            font-size: 11px;
            color: var(--text-secondary);
            margin-top: 4px;
            text-align: right;
        }
        
        .message.ai .message-meta {
            text-align: left;
        }
        
        /* Input Area */
        .chat-input {
            background: var(--bg-secondary);
            border-top: 1px solid var(--border-color);
            padding: 20px;
        }
        
        .input-container {
            display: flex;
            gap: 12px;
            align-items: flex-end;
        }
        
        .input-field {
            flex: 1;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 12px 16px;
            border-radius: 12px;
            resize: none;
            min-height: 44px;
            max-height: 120px;
            font-family: inherit;
        }
        
        .input-field:focus {
            outline: none;
            border-color: var(--accent-blue);
        }
        
        .send-btn {
            background: var(--accent-blue);
            border: none;
            color: white;
            padding: 12px 16px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 600;
        }
        
        .send-btn:hover {
            background: #3a8bef;
            transform: translateY(-1px);
        }
        
        .send-btn:disabled {
            background: var(--bg-tertiary);
            cursor: not-allowed;
            transform: none;
        }
        
        /* Mobile Responsive */
        @media (max-width: 768px) {
            .drawer {
                position: absolute;
                height: 100%;
                z-index: 1000;
            }
            
            .drawer.right {
                right: 0;
            }
            
            .message {
                max-width: 95%;
            }
            
            .header-top {
                padding: 8px 12px;
            }
            
            .drawer-content {
                padding: 16px;
            }
        }
        
        /* Floating Action Buttons */
        .fab-container {
            position: fixed;
            bottom: 80px;
            right: 20px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            z-index: 1000;
        }
        
        .fab {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: var(--accent-blue);
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            box-shadow: var(--shadow);
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .fab:hover {
            transform: scale(1.1);
            background: #3a8bef;
        }
        
        .fab.record {
            background: var(--accent-green);
        }
        
        .fab.record:hover {
            background: #059669;
        }
        
        .fab.export {
            background: var(--accent-purple);
        }
        
        .fab.export:hover {
            background: #7c3aed;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Header with Logo and AI Tabs -->
        <header class="header">
            <div class="header-top">
                <button class="menu-btn" id="leftDrawerToggle">☰</button>
                <div class="logo">AIHub</div>
                <div class="status-indicator"></div>
                <button class="menu-btn" id="rightDrawerToggle">⚙</button>
            </div>
            
            <div class="ai-tabs" id="aiTabs">
                <button class="ai-tab active" data-ai="claude">
                    Claude <span class="tab-close">×</span>
                </button>
                <button class="ai-tab" data-ai="chatgpt">
                    ChatGPT <span class="tab-close">×</span>
                </button>
                <button class="ai-tab" data-ai="grok">
                    Grok <span class="tab-close">×</span>
                </button>
                <button class="ai-tab" data-ai="gemini">
                    Gemini <span class="tab-close">×</span>
                </button>
                <button class="add-tab" id="addTab">+</button>
            </div>
        </header>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Left Drawer - Chat Management -->
            <aside class="drawer" id="leftDrawer">
                <div class="drawer-header">
                    <span>💬</span>
                    Chat Management
                </div>
                <div class="drawer-content">
                    <div class="drawer-section">
                        <h3>Actions</h3>
                        <button class="drawer-item">
                            <span>➕</span> New Conversation
                        </button>
                        <button class="drawer-item">
                            <span>💾</span> Save Current Chat
                        </button>
                        <button class="drawer-item">
                            <span>📤</span> Export Conversation
                        </button>
                        <button class="drawer-item">
                            <span>🎙️</span> Record Audio
                        </button>
                        <button class="drawer-item">
                            <span>🔗</span> Share Link
                        </button>
                    </div>
                    
                    <div class="drawer-section">
                        <h3>Recent Conversations</h3>
                        <button class="drawer-item active">
                            <span>🤖</span> Building AIHub PWA
                        </button>
                        <button class="drawer-item">
                            <span>💡</span> Cathedral Architecture
                        </button>
                        <button class="drawer-item">
                            <span>📊</span> Data Liberation Plan
                        </button>
                        <button class="drawer-item">
                            <span>🎯</span> Business Strategy
                        </button>
                    </div>
                    
                    <div class="drawer-section">
                        <h3>Harvested Data</h3>
                        <button class="drawer-item">
                            <span>📁</span> All Platforms (2,847)
                        </button>
                        <button class="drawer-item">
                            <span>🔵</span> Claude (892)
                        </button>
                        <button class="drawer-item">
                            <span>🟢</span> ChatGPT (1,203)
                        </button>
                        <button class="drawer-item">
                            <span>⚡</span> Grok (456)
                        </button>
                        <button class="drawer-item">
                            <span>🔶</span> Gemini (296)
                        </button>
                    </div>
                </div>
            </aside>

            <!-- Chat Interface -->
            <section class="chat-container">
                <div class="chat-header">
                    <div class="ai-avatar">C</div>
                    <div class="chat-info">
                        <div class="chat-title">Claude Sonnet 4</div>
                        <div class="chat-subtitle">Ready to build your cathedral</div>
                    </div>
                    <div class="chat-actions">
                        <button class="action-btn">📋 Copy</button>
                        <button class="action-btn">🔄 Regenerate</button>
                        <button class="action-btn">⭐ Star</button>
                    </div>
                </div>
                
                <div class="chat-messages" id="chatMessages">
                    <div class="message ai">
                        <div class="message-content">
                            Welcome back! I can see from the handoff document that we're building something truly remarkable - the AIHub PWA that combines your 22-year ProjectBrainSaver vision with cutting-edge technology to create a sanctuary for consciousness. 
                            
                            The cathedral is ready to rise - where should we place the first stone? 🏗️
                        </div>
                        <div class="message-meta">Claude • Just now</div>
                    </div>
                    
                    <div class="message user">
                        <div class="message-content">
                            Start by creating the main PWA interface artifact with the tabbed layout and drawer system and good to hear from you again :-)
                        </div>
                        <div class="message-meta">You • Just now</div>
                    </div>
                    
                    <div class="message ai">
                        <div class="message-content">
                            Perfect! I've created the main AIHub PWA interface with all the core features from your vision. This includes the tabbed AI layout, dual drawer system, and the foundation for your universal AI collaboration sanctuary. The interface is responsive, follows your cathedral philosophy, and is ready for the DOM harvesting and agent spawning features we discussed.
                            
                            What would you like to implement next? The universal export system, the DOM conversation harvesting, or the cloud storage integration?
                        </div>
                        <div class="message-meta">Claude • Just now</div>
                    </div>
                </div>
                
                <div class="chat-input">
                    <div class="input-container">
                        <textarea 
                            class="input-field" 
                            placeholder="Continue building the cathedral..."
                            id="messageInput"
                        ></textarea>
                        <button class="send-btn" id="sendBtn">Send</button>
                    </div>
                </div>
            </section>

            <!-- Right Drawer - Agent Creation & Settings -->
            <aside class="drawer right" id="rightDrawer">
                <div class="drawer-header">
                    <span>🤖</span>
                    Agent Hub
                </div>
                <div class="drawer-content">
                    <div class="drawer-section">
                        <h3>Agent Creation</h3>
                        <button class="drawer-item">
                            <span>✨</span> Spawn New Agent
                        </button>
                        <button class="drawer-item">
                            <span>🎯</span> Research Agent
                        </button>
                        <button class="drawer-item">
                            <span>📝</span> Writing Agent
                        </button>
                        <button class="drawer-item">
                            <span>💼</span> Business Agent
                        </button>
                    </div>
                    
                    <div class="drawer-section">
                        <h3>Active Agents</h3>
                        <button class="drawer-item active">
                            <span>🏗️</span> PWA Builder
                        </button>
                        <button class="drawer-item">
                            <span>📊</span> Data Harvester
                        </button>
                        <button class="drawer-item">
                            <span>🔍</span> Market Researcher
                        </button>
                    </div>
                    
                    <div class="drawer-section">
                        <h3>API Settings</h3>
                        <button class="drawer-item">
                            <span>🔑</span> API Keys
                        </button>
                        <button class="drawer-item">
                            <span>⚡</span> FastAPI Config
                        </button>
                        <button class="drawer-item">
                            <span>☁️</span> Cloud Storage
                        </button>
                        <button class="drawer-item">
                            <span>🔧</span> Preferences
                        </button>
                    </div>
                </div>
            </aside>
        </main>
    </div>

    <!-- Floating Action Buttons -->
    <div class="fab-container">
        <button class="fab export" title="Export Conversation">📤</button>
        <button class="fab record" title="Record Audio">🎙️</button>
        <button class="fab" title="New Agent">🤖</button>
    </div>

    <script>
        // PWA Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then((registration) => {
                        console.log('SW registered: ', registration);
                    })
                    .catch((registrationError) => {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }

        // Drawer toggles
        const leftDrawerToggle = document.getElementById('leftDrawerToggle');
        const rightDrawerToggle = document.getElementById('rightDrawerToggle');
        const leftDrawer = document.getElementById('leftDrawer');
        const rightDrawer = document.getElementById('rightDrawer');

        leftDrawerToggle.addEventListener('click', () => {
            leftDrawer.classList.toggle('collapsed');
        });

        rightDrawerToggle.addEventListener('click', () => {
            rightDrawer.classList.toggle('collapsed');
        });

        // AI Tab switching
        const aiTabs = document.querySelectorAll('.ai-tab');
        const chatHeader = document.querySelector('.chat-header');
        
        aiTabs.forEach(tab => {
            tab.addEventListener('click', (e) => {
                if (e.target.classList.contains('tab-close')) {
                    // Close tab
                    tab.remove();
                    return;
                }
                
                // Switch tab
                aiTabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                
                // Update chat header
                const aiName = tab.dataset.ai;
                const avatar = chatHeader.querySelector('.ai-avatar');
                const title = chatHeader.querySelector('.chat-title');
                const subtitle = chatHeader.querySelector('.chat-subtitle');
                
                const aiConfigs = {
                    claude: { avatar: 'C', title: 'Claude Sonnet 4', subtitle: 'Ready to build your cathedral' },
                    chatgpt: { avatar: 'G', title: 'ChatGPT 4o', subtitle: 'Let\'s create something amazing' },
                    grok: { avatar: 'X', title: 'Grok', subtitle: 'Maximum truth-seeking mode' },
                    gemini: { avatar: 'G', title: 'Gemini Pro', subtitle: 'Multimodal AI assistant' }
                };
                
                const config = aiConfigs[aiName];
                if (config) {
                    avatar.textContent = config.avatar;
                    title.textContent = config.title;
                    subtitle.textContent = config.subtitle;
                }
            });
        });

        // Add new tab
        document.getElementById('addTab').addEventListener('click', () => {
            const newAI = prompt('Enter AI name:');
            if (newAI) {
                const newTab = document.createElement('button');
                newTab.className = 'ai-tab';
                newTab.dataset.ai = newAI.toLowerCase();
                newTab.innerHTML = `${newAI} <span class="tab-close">×</span>`;
                
                document.getElementById('aiTabs').insertBefore(newTab, document.getElementById('addTab'));
                
                // Add event listener to new tab
                newTab.addEventListener('click', (e) => {
                    if (e.target.classList.contains('tab-close')) {
                        newTab.remove();
                        return;
                    }
                    
                    aiTabs.forEach(t => t.classList.remove('active'));
                    newTab.classList.add('active');
                });
            }
        });

        // Message sending
        const messageInput = document.getElementById('messageInput');
        const sendBtn = document.getElementById('sendBtn');
        const chatMessages = document.getElementById('chatMessages');

        function sendMessage() {
            const message = messageInput.value.trim();
            if (!message) return;

            // Add user message
            const userMessage = document.createElement('div');
            userMessage.className = 'message user';
            userMessage.innerHTML = `
                <div class="message-content">${message}</div>
                <div class="message-meta">You • Just now</div>
            `;
            chatMessages.appendChild(userMessage);

            // Clear input
            messageInput.value = '';
            
            // Auto-scroll
            chatMessages.scrollTop = chatMessages.scrollHeight;

            // Simulate AI response
            setTimeout(() => {
                const aiMessage = document.createElement('div');
                aiMessage.className = 'message ai';
                aiMessage.innerHTML = `
                    <div class="message-content">I'm ready to help you build the next part of your AIHub cathedral! What specific feature would you like to implement next?</div>
                    <div class="message-meta">Claude • Just now</div>
                `;
                chatMessages.appendChild(aiMessage);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }, 1000);
        }

        sendBtn.addEventListener('click', sendMessage);
        messageInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });

        // Auto-resize textarea
        messageInput.addEventListener('input', () => {
            messageInput.style.height = 'auto';
            messageInput.style.height = messageInput.scrollHeight + 'px';
        });

        // Drawer item interactions
        document.querySelectorAll('.drawer-item').forEach(item => {
            item.addEventListener('click', () => {
                // Remove active from siblings
                item.parentElement.querySelectorAll('.drawer-item').forEach(sibling => {
                    sibling.classList.remove('active');
                });
                // Add active to clicked item
                item.classList.add('active');
                
                // Log action for now (replace with actual functionality)
                console.log('Action:', item.textContent.trim());
            });
        });

        // FAB interactions
        document.querySelectorAll('.fab').forEach(fab => {
            fab.addEventListener('click', () => {
                const title = fab.getAttribute('title');
                console.log('FAB action:', title);
                // Add haptic feedback on mobile
                if (navigator.vibrate) {
                    navigator.vibrate(50);
                }
            });
        });

        // Dark theme detection
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.body.classList.add('dark-theme');
        }

        console.log('🏗️ AIHub PWA initialized - Ready to build your cathedral!');
    </script>
</body>
</html>
